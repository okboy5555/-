/*! demo 2017-09-04 */

var routerApp=angular.module("routerApp",["ui.router","BookListModule","ngGrid"]);routerApp.run(function(e,t,i){e.$state=t,e.$stateParams=i}),routerApp.config(function(e,t){t.otherwise("/index"),e.state("index",{url:"/index",views:{"":{templateUrl:"tpls/home.html"},"main@index":{templateUrl:"tpls/loginForm.html"}}}).state("booklist",{url:"/{bookType:[0-9]{1,4}}",views:{"":{templateUrl:"tpls/bookList.html"},"booktype@booklist":{templateUrl:"tpls/bookType.html"},"bookgrid@booklist":{templateUrl:"tpls/bookGrid.html"}}}).state("addbook",{url:"/addbook",templateUrl:"tpls/addBook.html"}).state("bookdetail",{url:"/bookdetail/:bookId",templateUrl:"tpls/bookDetail.html"})});var bookListModule=angular.module("BookListModule",[]);bookListModule.controller("BookListCtrl",function(e,t,i,l){e.filterOptions={filterText:"",useExternalFilter:!0},e.totalServerItems=0,e.pagingOptions={pageSizes:[5,10,20],pageSize:6,currentPage:1},e.setPagingData=function(t,i,l){var o=t.slice((i-1)*l,i*l);e.books=o,e.totalServerItems=t.length,e.$$phase||e.$apply()},e.getPagedDataAsync=function(i,o,a){setTimeout(function(){var n;if(a){var r=a.toLowerCase();t.get("../src/data/books"+l.bookType+".json").success(function(t){n=t.filter(function(e){return-1!=JSON.stringify(e).toLowerCase().indexOf(r)}),e.setPagingData(n,o,i)})}else t.get("../src/data/books"+l.bookType+".json").success(function(t){e.setPagingData(t,o,i)})},100)},e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage),e.$watch("pagingOptions",function(t,i){t!==i&&t.currentPage!==i.currentPage&&e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},!0),e.$watch("filterOptions",function(t,i){t!==i&&e.getPagedDataAsync(e.pagingOptions.pageSize,e.pagingOptions.currentPage,e.filterOptions.filterText)},!0),e.gridOptions={data:"books",rowTemplate:'<div style="height: 100%"><div ng-style="{ \'cursor\': row.cursor }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngCell "><div class="ngVerticalBar" ng-style="{height: rowHeight}" ng-class="{ ngVerticalBarVisible: !$last }"> </div><div ng-cell></div></div></div>',multiSelect:!1,enableCellSelection:!0,enableRowSelection:!1,enableCellEdit:!0,enablePinning:!0,columnDefs:[{field:"index",displayName:"序号",width:60,pinnable:!1,sortable:!1},{field:"name",displayName:"书名",enableCellEdit:!0},{field:"author",displayName:"作者",enableCellEdit:!0,width:220},{field:"pubTime",displayName:"出版日期",enableCellEdit:!0,width:120},{field:"price",displayName:"定价",enableCellEdit:!0,width:120,cellFilter:'currency:"￥"'},{field:"bookId",displayName:"操作",enableCellEdit:!1,sortable:!1,pinnable:!1,cellTemplate:'<div><a ui-sref="bookdetail({bookId:row.getProperty(col.field)})" id="{{row.getProperty(col.field)}}">详情</a></div>'}],enablePaging:!0,showFooter:!0,totalServerItems:"totalServerItems",pagingOptions:e.pagingOptions,filterOptions:e.filterOptions}});